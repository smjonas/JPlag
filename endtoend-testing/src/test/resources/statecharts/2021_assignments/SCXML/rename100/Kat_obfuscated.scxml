<?xml version="1.0" encoding="UTF-8"?>
<scxml xmlns="http://www.w3.org/2005/07/scxml" version="1.0" datamodel="ecmascript" name="Kat">
	<datamodel>
		<data expr="1" id="stopsAt" />
		<data expr="6" id="remainingCapacity" />
		<data expr="0" id="numPassengers" />
		<data expr="0.0" id="currentSpeed" />
		<data expr="0" id="stop" />
		<data expr="0" id="arrivingStation" />
		<data expr="0" id="check" />
		<data expr="0" id="timer" />
	</datamodel>
	<state id="QDbb5nHQ2K">
		<initial>
			<transition target="vydA4eoN6t" type="internal">
			</transition>
		</initial>
		<parallel id="vydA4eoN6t">
			<state id="wIuvL5B85P">
				<initial>
					<transition target="SN8NKA06nO" type="internal">
					</transition>
				</initial>
				<state id="SN8NKA06nO">
					<transition event="requestStop"  target="lKgS4f4lBA">
					</transition>
				</state>
				<state id="lKgS4f4lBA">
					<onentry>
						 <assign location="stop" expr="_event.data"/>
						 <assign location="stopsAt" expr="stopsAt | (1 &lt;&lt; stop)"/>
						<send event="refreshUI">
						</send>
					</onentry>
					<transition event="requestStop"  target="lKgS4f4lBA">
					</transition>
				</state>
			</state>
			<state id="RMo7JuxX6v">
				<initial>
					<transition target="zS55Q1tC2u" type="internal">
					</transition>
				</initial>
				<state id="LC2FfXiR9z">
					<transition event="allowBoarding"  target="zS55Q1tC2u">
					</transition>
				</state>
				<state id="Z2pBkYvGSC">
					<onentry>
						<send event="Z2pBkYvGSC_t_0_timeEvent_0" delay="1s"/>
					</onentry>
					<onexit>
						<cancel sendid="Z2pBkYvGSC_t_0_timeEvent_0" />
					</onexit>
					<onentry>
						 <assign location="remainingCapacity" expr="remainingCapacity - 1"/>
						 <assign location="numPassengers" expr="numPassengers + 1"/>
						<send event="refreshUI">
						</send>
					</onentry>
					<transition event="Z2pBkYvGSC_t_0_timeEvent_0"  target="YioZmx0FlU">
					</transition>
				</state>
				<state id="zS55Q1tC2u">
					<transition event="blockBoarding"  target="LC2FfXiR9z">
					</transition>
					<transition event="board" cond="remainingCapacity &gt; 0" target="Z2pBkYvGSC">
						<send event="setTimer">
						<content expr="1000" />
						</send>
					</transition>
					<transition event="unboard" cond="numPassengers &gt; 0" target="vovrN46I16">
						<send event="setTimer">
						<content expr="1000" />
						</send>
					</transition>
				</state>
				<state id="vovrN46I16">
					<onentry>
						<send event="vovrN46I16_t_0_timeEvent_0" delay="1s"/>
					</onentry>
					<onexit>
						<cancel sendid="vovrN46I16_t_0_timeEvent_0" />
					</onexit>
					<onentry>
						 <assign location="remainingCapacity" expr="remainingCapacity + 1"/>
						 <assign location="numPassengers" expr="numPassengers - 1"/>
						<send event="refreshUI">
						</send>
					</onentry>
					<transition event="vovrN46I16_t_0_timeEvent_0"  target="YioZmx0FlU">
					</transition>
				</state>
				<state id="YioZmx0FlU">
					<onentry>
						<send event="setTimer">
						<content expr="1000" />
						</send>
					</onentry>
					<transition   target="zS55Q1tC2u">
					</transition>
				</state>
			</state>
			<state id="NwdqzG2tEl">
				<initial>
					<transition target="XefBDGboVD" type="internal">
					</transition>
				</initial>
				<state id="XefBDGboVD">
					<initial>
						<transition target="veTmKRZNmQ" type="internal">
						</transition>
					</initial>
					<state id="veTmKRZNmQ">
					</state>
					<state id="J8AgNhclfa">
						<initial>
							<transition target="wyE5Ewy398" type="internal">
							</transition>
						</initial>
						<state id="wyE5Ewy398">
							<onentry>
								<send event="wyE5Ewy398_t_0_timeEvent_0" delay="10ms"/>
							</onentry>
							<onexit>
								<cancel sendid="wyE5Ewy398_t_0_timeEvent_0" />
							</onexit>
							<transition event="wyE5Ewy398_t_0_timeEvent_0" cond="timer &gt; 0" target="wyE5Ewy398">
								 <assign location="timer" expr="timer - 10"/>
							</transition>
							<transition  cond="timer == 0" target="veTmKRZNmQ">
								<send event="timerOver">
								</send>
							</transition>
						</state>
					</state>
					<transition event="setTimer"  target="J8AgNhclfa">
						 <assign location="timer" expr="_event.data"/>
					</transition>
				</state>
			</state>
			<state id="Route">
				<initial>
					<transition target="Normal" type="internal">
					</transition>
				</initial>
				<state id="Normal">
					<initial>
						<transition target="BbsSSIyCw3" type="internal">
						 <assign location="arrivingStation" expr="0"/>
						</transition>
					</initial>
					<state id="BbsSSIyCw3">
						<initial>
							<transition target="CldRGu66Az" type="internal">
							</transition>
						</initial>
						<state id="ZHQtlSdQMc">
							<transition  cond="stopsAt &gt; 0 &amp;&amp; stop != arrivingStation" target="ugaeuKPMyC">
							</transition>
						</state>
						<state id="BbsSSIyCw3.choice_0">
							<transition  cond="stopsAt &gt; 0" target="ugaeuKPMyC">
							</transition>
							<transition   target="ZHQtlSdQMc">
							</transition>
						</state>
						<state id="CldRGu66Az">
							<onentry>
								<send event="CldRGu66Az_t_0_timeEvent_0" delay="2s"/>
							</onentry>
							<onexit>
								<cancel sendid="CldRGu66Az_t_0_timeEvent_0" />
							</onexit>
							<transition event="CldRGu66Az_t_0_timeEvent_0"  target="BbsSSIyCw3.choice_0">
								 <assign location="stopsAt" expr="stopsAt &amp; ~(1 &lt;&lt; arrivingStation)"/>
							</transition>
						</state>
					</state>
					<history type = "shallow" id="Gwtm08MwOC">
						<transition target="BbsSSIyCw3">
						</transition>
					</history>
					<state id="ClosedDoors">
						<initial>
							<transition target="ugaeuKPMyC" type="internal">
							</transition>
						</initial>
						<state id="U2plJAv2gv">
							<onentry>
								 <assign location="currentSpeed" expr="24"/>
								<send event="setTargetSpeed">
								<content expr="currentSpeed" />
								</send>
							</onentry>
							<transition event="atTargetSpeed"  target="f0jUHX2KgY">
							</transition>
						</state>
						<state id="nYfrZShNkp">
							<onentry>
								<send event="nYfrZShNkp_t_0_timeEvent_0" delay="1ms"/>
							</onentry>
							<onexit>
								<cancel sendid="nYfrZShNkp_t_0_timeEvent_0" />
							</onexit>
							<onentry>
								 <assign location="arrivingStation" expr="_event.data"/>
								 <assign location="check" expr="stopsAt &amp; (1 &lt;&lt; arrivingStation)"/>
								<send event="refreshUI">
								</send>
							</onentry>
							<transition event="nYfrZShNkp_t_0_timeEvent_0"  target="ClosedDoors.choice_0">
							</transition>
						</state>
						<state id="ClosedDoors.choice_0">
							<transition  cond="check != 0" target="Mpcaxy5qDn">
							</transition>
							<transition   target="f0jUHX2KgY">
							</transition>
						</state>
						<state id="Mpcaxy5qDn">
							<onentry>
								<send event="setTargetSpeed">
								<content expr="0" />
								</send>
							</onentry>
							<transition event="atTargetSpeed"  target="y9BpTLmlvN">
							</transition>
						</state>
						<state id="f0jUHX2KgY">
							<transition event="approachingStation"  target="nYfrZShNkp">
							</transition>
						</state>
						<state id="tbxSkifOEw">
							<onentry>
								<send event="tbxSkifOEw_t_0_timeEvent_0" delay="1s"/>
							</onentry>
							<onexit>
								<cancel sendid="tbxSkifOEw_t_0_timeEvent_0" />
							</onexit>
							<onentry>
								<send event="closeDoors">
								</send>
								<send event="blockBoarding">
								</send>
								<send event="stopDoorsSignal">
								</send>
								<send event="refreshUI">
								</send>
							</onentry>
							<transition event="tbxSkifOEw_t_0_timeEvent_0"  target="U2plJAv2gv">
							</transition>
						</state>
						<state id="y9BpTLmlvN">
							<onentry>
								<send event="y9BpTLmlvN_t_0_timeEvent_0" delay="1s"/>
							</onentry>
							<onexit>
								<cancel sendid="y9BpTLmlvN_t_0_timeEvent_0" />
							</onexit>
							<onentry>
								 <assign location="currentSpeed" expr="0"/>
							</onentry>
							<transition event="y9BpTLmlvN_t_0_timeEvent_0"  target="BbsSSIyCw3">
								<send event="openDoors">
								</send>
								<send event="refreshUI">
								</send>
								<send event="allowBoarding">
								</send>
							</transition>
						</state>
						<state id="ugaeuKPMyC">
							<onentry>
								<send event="startDoorsSignal">
								</send>
								<send event="refreshUI">
								</send>
								<send event="setTimer">
								<content expr="1000" />
								</send>
							</onentry>
							<transition event="timerOver"  target="tbxSkifOEw">
							</transition>
						</state>
					</state>
					<transition event="startEmergency"  target="Opgz7yfDsM">
					</transition>
				</state>
				<state id="Opgz7yfDsM">
					<initial>
						<transition target="Opgz7yfDsM.choice_0" type="internal">
						</transition>
					</initial>
					<state id="EmergencyStop">
						<onentry>
							<send event="openDoors">
							</send>
							<send event="allowBoarding">
							</send>
						</onentry>
						<transition event="stopEmergency"  target="Gwtm08MwOC">
						</transition>
					</state>
					<state id="Opgz7yfDsM.choice_0">
						<transition  cond="currentSpeed == 0.0" target="EmergencyStop">
						</transition>
						<transition   target="iphxiOQBpB">
						</transition>
					</state>
					<state id="iphxiOQBpB">
						<onentry>
							<send event="setTargetSpeed">
							<content expr="0" />
							</send>
							<send event="refreshUI">
							</send>
						</onentry>
						<transition event="atTargetSpeed"  target="EmergencyStop">
						</transition>
					</state>
				</state>
			</state>
		</parallel>
	</state>
</scxml>
